<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Study Discussion Club</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- React + Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- ✅ Firebase UMD (compat) -->
    <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore-compat.js"></script>

    <style>
      body { margin:0; font-family:"Segoe UI",Arial,sans-serif; }
      input { padding:10px; border-radius:8px; margin-bottom:10px; width:100%; border:1px solid #ccc; }
      button { background-color:#007aff; padding:12px; border-radius:8px; margin-top:10px; width:100%; text-align:center; color:white; font-weight:bold; border:none; cursor:pointer; }
      .container { display:flex; flex-direction:column; align-items:center; justify-content:center; padding:20px; min-height:100vh; text-align:center; }
      .exam-box, .menu-btn { padding:15px; border-radius:10px; margin:8px; width:90%; max-width:400px; border:1px solid #ccc; cursor:pointer; background-color:#fff; }
      .feature-box { background:#fff; padding:15px; border-radius:12px; text-align:left; width:90%; max-width:420px; box-shadow:0 2px 6px rgba(0,0,0,0.1); margin-bottom:10px; }
      .notice-box { background:#fff7e6; border:1px solid #ffb347; border-radius:8px; padding:12px; margin-top:15px; width:90%; max-width:420px; }
      .image-frame { background:white; padding:10px; margin:10px 0; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.2); width:90%; max-width:400px; }
      .image-frame img { width:100%; border-radius:10px; }
      .back-btn { color:#007aff; cursor:pointer; font-weight:bold; align-self:flex-start; margin-bottom:10px; }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // --- Initialize Firebase ---
      const firebaseConfig = {
        apiKey: "AIzaSyDwbIHTMWM_AQ-NlsdXGDzAfoC8Tf8lZiY",
        authDomain: "study-discussion-club.firebaseapp.com",
        projectId: "study-discussion-club",
        storageBucket: "study-discussion-club.appspot.com",
        messagingSenderId: "383378613377",
        appId: "1:383378613377:web:3b932c6b42076352811980"
      };
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      function App(){
        const [screen,setScreen] = useState("welcome");
        const [signupData,setSignupData] = useState({username:"",email:"",password:"",mobile:"",pin:""});
        const [loginData,setLoginData] = useState({email:"",password:""});
        const [selectedExam,setSelectedExam] = useState(null);
        const [paymentStatus,setPaymentStatus] = useState("pending");
        const [manualNotice,setManualNotice] = useState(false);

        const contentImages = {
          "Current Affairs": [
            "https://raw.githubusercontent.com/demo/demo-repo/main/current1.jpg",
            "https://raw.githubusercontent.com/demo/demo-repo/main/current2.jpg"
          ],
          "Practice Questions": [
            "https://raw.githubusercontent.com/demo/demo-repo/main/practice1.jpg",
            "https://raw.githubusercontent.com/demo/demo-repo/main/practice2.jpg"
          ],
          "Mind Maps": [
            "https://raw.githubusercontent.com/demo/demo-repo/main/mind1.jpg"
          ],
          "UPSC Books Summary": [
            "https://raw.githubusercontent.com/demo/demo-repo/main/book1.jpg"
          ],
          "Interview Practice Questions": [
            "https://raw.githubusercontent.com/demo/demo-repo/main/interview1.jpg"
          ]
        };

        const bgColors = {
          "Current Affairs":"#E6E6FA",
          "Practice Questions":"#B0E0E6",
          "Mind Maps":"#A9A9A9",
          "UPSC Books Summary":"#F0E68C",
          "Interview Practice Questions":"#ADD8E6"
        };

        // --- Payment timeout notice ---
        useEffect(()=>{
          if(screen==="payment" && paymentStatus==="pending"){
            const timer=setTimeout(()=>setManualNotice(true),180000);
            return ()=>clearTimeout(timer);
          }
        },[screen,paymentStatus]);

        // --- Signup ---
        const handleSignup = async ()=>{
          const { username,email,password,mobile,pin } = signupData;
          if(!email || !password){ alert("Please fill all details"); return; }
          try{
            const userCred = await auth.createUserWithEmailAndPassword(email,password);
            const user = userCred.user;
            await db.collection("users").doc(user.uid).set({username,email,mobile,pin,createdAt:new Date().toISOString()});
            alert("Signup successful ✅");
            setScreen("examlist");
          } catch(err){ alert("Signup failed ❌ "+err.message); }
        };

        // --- Login ---
        const handleLogin = async ()=>{
          try{
            await auth.signInWithEmailAndPassword(loginData.email,loginData.password);
            alert("Login successful ✅");
            setScreen("examlist");
          } catch(err){ alert("Login failed ❌ "+err.message); }
        };

        // --- Screens ---
        if(screen==="welcome")
          return (
            <div className="container" style={{backgroundColor:"#90EE90"}}>
              <h2>Welcome to Study Discussion Club</h2>
              <p>Developed by Sajan</p>
              <button onClick={()=>setScreen("signup")}>Next</button>
            </div>
          );

        if(screen==="signup"){
          const filled = Object.values(signupData).every(v=>v.trim()!=="");
          return (
            <div className="container" style={{backgroundColor:"#89CFF0"}}>
              <h2>Signup</h2>
              {Object.keys(signupData).map(key=>(
                <input key={key} placeholder={key.toUpperCase()} type={key==="password"||key==="pin"?"password":"text"} value={signupData[key]} onChange={e=>setSignupData({...signupData,[key]:e.target.value})}/>
              ))}
              <button style={{backgroundColor:filled?"#007AFF":"gray", cursor:filled?"pointer":"not-allowed"}} onClick={handleSignup}>Signup</button>
              <p style={{color:"#007AFF", cursor:"pointer"}} onClick={()=>setScreen("login")}>Already have an account?</p>
            </div>
          );
        }

        if(screen==="login")
          return (
            <div className="container" style={{backgroundColor:"#D3D3D3"}}>
              <h2>Login</h2>
              <input placeholder="Email" value={loginData.email} onChange={e=>setLoginData({...loginData,email:e.target.value})}/>
              <input type="password" placeholder="Password" value={loginData.password} onChange={e=>setLoginData({...loginData,password:e.target.value})}/>
              <button onClick={handleLogin}>Login</button>
            </div>
          );

        if(screen==="examlist"){
          const exams = ["UPSC","NEET","JEE","NDA","JUDICIARY"];
          return (
            <div className="container" style={{backgroundColor:"#FF7F7F"}}>
              <h2>Select Exam</h2>
              {exams.map(exam=>(
                <div key={exam} className="exam-box" onClick={()=>setSelectedExam(exam)} style={{backgroundColor:selectedExam===exam?"#FF4500":"#fff"}}>{exam}</div>
              ))}
              <button disabled={!selectedExam} style={{backgroundColor:selectedExam?"#007AFF":"gray", cursor:selectedExam?"pointer":"not-allowed"}} onClick={()=>setScreen("payment")}>Next</button>
            </div>
          );
        }

        if(screen==="payment"){
          const features = [
            "Daily Current Affairs",
            "Daily Practice Questions",
            "Mind Maps and UPSC Books Summary",
            "Discussion and Contest Entry Fee"
          ];
          return (
            <div className="container" style={{backgroundColor:"#FFF8DC"}}>
              <h2>Subscription</h2>
              <h3>{selectedExam}</h3>
              <div className="feature-box">{features.map((f,i)=><p key={i}>• {f}</p>)}</div>
              <button onClick={()=>{ setPaymentStatus("success"); setTimeout(()=>setScreen("home"),1500); }}>Pay Now</button>
              {manualNotice && <div className="notice-box">Our team will manually verify your payment. Once confirmed, your plan will be activated.</div>}
            </div>
          );
        }

        if(screen==="home"){
          const menu = ["Current Affairs","Practice Questions","Entry Fee / Contest","Mind Maps","UPSC Books Summary","Interview Practice Questions","Hidden Topics","Discussion","Live Classes","Donation Bank","SDC News"];
          const colors = ["#FFFACD","#B0E0E6","#FFDAB9","#E6E6FA","#ADD8E6","#F0E68C","#D8BFD8","#F5DEB3","#FFA500","#A0522D","#FFE4B5"];
          return (
            <div className="container" style={{backgroundColor:"#FFFFE0"}}>
              <h2>Study Discussion Club</h2>
              {menu.map((item,i)=>(
                <div key={item} className="menu-btn" style={{backgroundColor:colors[i%colors.length], color:"black"}} onClick={()=>setScreen(item)}>{item}</div>
              ))}
            </div>
          );
        }

        if(screen in contentImages){
          const imgs = [...contentImages[screen]].reverse(); // latest on top
          return (
            <div className="container" style={{backgroundColor:bgColors[screen]||"#fff"}}>
              <div className="back-btn" onClick={()=>setScreen("home")}>← Back</div>
              <h2>{screen}</h2>
              {imgs.length>0 ? imgs.map((img,idx)=>(
                <div className="image-frame" key={idx}><img src={img} alt={`${screen} ${idx}`} /></div>
              )) : <p>No content uploaded yet.</p>}
            </div>
          );
        }

        return <div className="container"><p>Loading...</p></div>;
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
